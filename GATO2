Program Juego_de_Gato;
Uses
    crt;
Var
   G:array [1..3,1..3] of integer;
   t,i,l,c,h1,g1,p1,Q,wq:integer;
   letra1,letra2,a1,a2,a3,a4,a5,a6,a7,a8,a9:char;
   nom1,nom2,ayu:string;
   error,corre,xz:integer;
   numeros,mar,pre,ju1,ju2,contra,co:integer;
   z:array [1..45] of integer;
procedure ayuda;
begin
     gotoxy(55,2);
     textcolor(red);
     writeln('Presione * para Ayuda');
end;
procedure ayuda1;
begin
     gotoxy(62,8);
     textcolor(10);
     writeln('OPCIONES');
     gotoxy(55,10);
     textcolor(19);
     writeln('Presione 99 para Ayuda');
end;
Procedure configuracion;
begin
     gotoxy(55,15);
     textcolor(18);
     writeln('Presione 00 para ir a ');
     gotoxy(55,16);
     writeln('Configuraci¢n');
end;
Procedure salirfin;
begin
     gotoxy(55,22);
     textcolor(17);
     writeln('Presione 55 para Salir');
end;

Procedure Ayerror;
begin
     clrscr;
     textcolor(2);
     gotoxy(20,2);
     writeln('Error al cargar los datos');
     textcolor(15);
     gotoxy(5,4);
     writeln('Este error se puede producir por diferentes causas');
     gotoxy(5,5);
     writeln('entre las cuales se encuentran usted solo digito');
     gotoxy(5,6);
     writeln('un nombre entonces la computadora lo detecta como');
     gotoxy(5,7);
     writeln('un error,usted no digito ningun nombre la computadora');
     gotoxy(5,8);
     writeln('no encuentra la informaci¢n produciendo error,el');
     gotoxy(5,9);
     writeln('error tambien se puede producir porque sendos nombres');
     gotoxy(5,10);
     writeln('son iguales produciendo falla de la informaci¢n de la');
     gotoxy(5,11);
     writeln('computadora, ahora intelo de nuevo, gracias por utilizar');
     gotoxy(5,12);
     writeln('la ayuda.');
     readkey;
end;
Procedure ayudinfo;
begin
     clrscr;
     textcolor(2);
     gotoxy(30,2);
     writeln('Instruciones del juego');
     textcolor(15);
     gotoxy(6,5);
     writeln('El jugar GATO es una cuestion de agilidad en la que cada');
     gotoxy(6,6);
     writeln('jugador debe pensar su jugada con el fin de ganar.');
     gotoxy(6,7);
     writeln('El jugador #1 jugara con "O" mientras el jugador #2 jugara');
     gotoxy(6,8);
     writeln('con "X", usted observara en el cuadro del gato numeros');
     gotoxy(6,9);
     writeln('sobre cada casilla, este numero indicara la posici¢n en que');
     gotoxy(6,10);
     writeln('se ubicara la jugada, en la parte superior Izquierda apecera');
     gotoxy(6,11);
     writeln('una pregunta que le indica el nombre del jugador en turno y');
     gotoxy(6,12);
     writeln('y le pedira su jugada. Mediante los numeros de las casillas');
     gotoxy(6,13);
     writeln('usted se guiara y hubicara su jugada.');
     textcolor(2);
     gotoxy(30,15);
     writeln('Objetivo del Juego');
     textcolor(15);
     gotoxy(6,17);
     writeln('El objetivo del juego es hubicar sus jugadas de forma que');
     gotoxy(6,18);
     writeln('se forme una linea de tres de las mismas jugadas ya sea en');
     gotoxy(6,19);
     writeln('forma vertical, horizontal o diagonal y asi ganar el juego');
     readkey;
end;
Procedure ayuconfi;
begin
     clrscr;
     textcolor(2);
     gotoxy(30,2);
     writeln('Utilizacion');
     textcolor(15);
     gotoxy(6,5);
     writeln('La configuracion se realizo con el fin de que los usuarios');
     gotoxy(6,6);
     writeln('del juego(jugadores)puedan escojer los colores a su gusto.');
     gotoxy(6,7);
     writeln('En el menu principal aparecen varias opciones usted puede');
     gotoxy(6,8);
     writeln('escojer la que decee y personalizar el juego a su gusto.');
     gotoxy(6,9);
     writeln('Para aserlo solo debe escojer el numero del color que decea');
     gotoxy(6,10);
     writeln('y presionar enter luego salga, y observe el cambio. Si los');
     gotoxy(6,11);
     writeln('cambios realizados no le satisfacen y decea recobrar la');
     gotoxy(6,12);
     writeln('configuracion original solo bebe ir a la opcion reestablecer');
     gotoxy(6,13);
     writeln('valores.');
     readkey;
end;
Procedure temas;
var
   ayud:integer;
begin
     clrscr;
     textcolor(red);
     gotoxy(25,2);
     writeln('Usted esta utilizando la ayuda');
     textcolor(11);
     gotoxy(15,5);
     writeln('1.Objetivo e instrucciones del juego');
     gotoxy(15,6);
     writeln('2.Porque da error al cargar los datos');
     gotoxy(15,7);
     writeln('3.Utilizacion de la configuracion');
     gotoxy(15,8);
     writeln('4.Salir de la ayuda');
     gotoxy(15,14);
     writeln('Que tema quiere ver');
     gotoxy(15,15);
     writeln('[ ]');
     gotoxy(16,15);
     readln(ayud);
     case  ayud of
           1:begin
                  ayudinfo;
                  temas;
            end;
           2:begin
                  Ayerror;
                  temas;
             end;
           3:begin
                  ayuconfi;
                  temas;
            end;
           4:begin
                  writeln(**);
            end;
     end;
end;
Procedure temacolornumeros;
var
   ayud:integer;
begin
     clrscr;
     textcolor(red);
     gotoxy(25,2);
     writeln('Elija el color que quiere');
     textcolor(11);
     gotoxy(15,5);
     writeln('1.Color Rojo');
     gotoxy(15,6);
     writeln('2.Color Verde');
     gotoxy(15,7);
     writeln('3.Color Morado');
     gotoxy(15,8);
     writeln('4.Color Azul');
     gotoxy(15,9);
     writeln('5.Color Blanco');
     gotoxy(15,10);
     writeln('6.Color amarillo');
     gotoxy(15,11);
     writeln('7.Regresar al menu principal');
     gotoxy(15,14);
     writeln('Que color escoge o regresar');
     gotoxy(15,15);
     writeln('[ ]');
     gotoxy(16,15);
     readln(ayud);
     case  ayud of
           1:begin
                  numeros:=4;
                  writeln(**);
            end;
           2:begin
                  numeros:=2;
                  writeln(**);
             end;
           3:begin
                  numeros:=5;
                  writeln(**);
            end;
           4:begin
                   numeros:=1;
                   writeln(**);
            end;
           5:begin
                   numeros:=15;
                   writeln(**);
             end;
           6:begin
                   numeros:=14;
                   writeln(**);
             end;

           7:begin
                  writeln(**);
            end;
     end;
end;
Procedure colormarco;
var
   ayud:integer;
begin
     clrscr;
     textcolor(red);
     gotoxy(25,2);
     writeln('Elija el color que quiere');
     textcolor(11);
     gotoxy(15,5);
     writeln('1.Color Rojo');
     gotoxy(15,6);
     writeln('2.Color Verde');
     gotoxy(15,7);
     writeln('3.Color Morado');
     gotoxy(15,8);
     writeln('4.Color Azul');
     gotoxy(15,9);
     writeln('5.Color Blanco');
     gotoxy(15,10);
     writeln('6.Color amarillo');
     gotoxy(15,11);
     writeln('7.Regresar al menu principal');
     gotoxy(15,14);
     writeln('Que color escoge o regresar');
     gotoxy(15,15);
     writeln('[ ]');
     gotoxy(16,15);
     readln(ayud);
     case  ayud of
           1:begin
                  mar:=4;
                  writeln(**);
            end;
           2:begin
                  mar:=2;
                  writeln(**);
             end;
           3:begin
                  mar:=5;
                  writeln(**);
            end;
           4:begin
                   mar:=1;
                   writeln(**);
            end;
           5:begin
                   mar:=15;
                   writeln(**);
             end;
           6:begin
                   mar:=14;
                   writeln(**);
             end;

           7:begin
                  writeln(**);
            end;
     end;
end;
Procedure colorpregunta;
var
   ayud:integer;
begin
     clrscr;
     textcolor(red);
     gotoxy(25,2);
     writeln('Elija el color que quiere');
     textcolor(11);
     gotoxy(15,5);
     writeln('1.Color Rojo');
     gotoxy(15,6);
     writeln('2.Color Verde');
     gotoxy(15,7);
     writeln('3.Color Morado');
     gotoxy(15,8);
     writeln('4.Color Azul');
     gotoxy(15,9);
     writeln('5.Color Blanco');
     gotoxy(15,10);
     writeln('6.Color amarillo');
     gotoxy(15,11);
     writeln('7.Regresar al menu principal');
     gotoxy(15,14);
     writeln('Que color escoge o regresar');
     gotoxy(15,15);
     writeln('[ ]');
     gotoxy(16,15);
     readln(ayud);
     case  ayud of
           1:begin
                  pre:=4;
                  writeln(**);
            end;
           2:begin
                  pre:=2;
                  writeln(**);
             end;
           3:begin
                  pre:=5;
                  writeln(**);
            end;
           4:begin
                   pre:=1;
                   writeln(**);
            end;
           5:begin
                   pre:=15;
                   writeln(**);
             end;
           6:begin
                   pre:=14;
                   writeln(**);
             end;

           7:begin
                  writeln(**);
            end;
     end;
end;
Procedure colorjugadas1;
var
   ayud:integer;
begin
     clrscr;
     textcolor(red);
     gotoxy(25,2);
     writeln('Elija el color que quiere');
     textcolor(11);
     gotoxy(15,5);
     writeln('1.Color Rojo');
     gotoxy(15,6);
     writeln('2.Color Verde');
     gotoxy(15,7);
     writeln('3.Color Morado');
     gotoxy(15,8);
     writeln('4.Color Azul');
     gotoxy(15,9);
     writeln('5.Color Blanco');
     gotoxy(15,10);
     writeln('6.Color amarillo');
     gotoxy(15,11);
     writeln('7.Regresar al menu');
     gotoxy(15,14);
     writeln('Que color escoge o regresar');
     gotoxy(15,15);
     writeln('[ ]');
     gotoxy(16,15);
     readln(ayud);
     case  ayud of
           1:begin
                  ju1:=4;
                  writeln(**);
            end;
           2:begin
                  ju1:=2;
                  writeln(**);
             end;
           3:begin
                  ju1:=5;
                  writeln(**);
            end;
           4:begin
                   ju1:=1;
                   writeln(**);
            end;
           5:begin
                   ju1:=15;
                   writeln(**);
             end;
           6:begin
                   ju1:=14;
                   writeln(**);
             end;
           7:begin
                  writeln(**);
            end;
     end;
end;
Procedure colorjugadas2;
var
   ayud:integer;
begin
     clrscr;
     textcolor(red);
     gotoxy(25,2);
     writeln('Elija el color que quiere');
     textcolor(11);
     gotoxy(15,5);
     writeln('1.Color Rojo');
     gotoxy(15,6);
     writeln('2.Color Verde');
     gotoxy(15,7);
     writeln('3.Color Morado');
     gotoxy(15,8);
     writeln('4.Color Azul');
     gotoxy(15,9);
     writeln('5.Color Blanco');
     gotoxy(15,10);
     writeln('6.Color amarillo');
     gotoxy(15,11);
     writeln('7.Regresar al menu ');
     gotoxy(15,14);
     writeln('Que color escoge o regresar');
     gotoxy(15,15);
     writeln('[ ]');
     gotoxy(16,15);
     readln(ayud);
     case  ayud of
           1:begin
                  ju2:=4;
                  writeln(**);
            end;
           2:begin
                  ju2:=2;
                  writeln(**);
             end;
           3:begin
                  ju2:=5;
                  writeln(**);
            end;
           4:begin
                   ju2:=1;
                   writeln(**);
            end;
           5:begin
                   ju2:=15;
                   writeln(**);
             end;
           6:begin
                   ju2:=14;
                   writeln(**);
             end;
           7:begin
                  writeln(**);
            end;
     end;
end;
Procedure colorjugadaescoger;
var
   ayud:integer;
begin
     clrscr;
     textcolor(red);
     gotoxy(25,2);
     writeln('A cual jugador decea cambiar el color');
     textcolor(11);
     gotoxy(15,5);
     writeln('1.Jugador #1');
     gotoxy(15,6);
     writeln('2.Jugador #2');
     gotoxy(15,7);
     writeln('3.Salir al menu principal');
     gotoxy(15,14);
     writeln('Que realizara');
     gotoxy(15,15);
     writeln('[ ]');
     gotoxy(16,15);
     readln(ayud);
     case  ayud of
           1:begin
                  colorjugadas1;
                  colorjugadaescoger;
            end;
           2:begin
                  colorjugadas2;
                  colorjugadaescoger;
             end;
           3:begin
                  writeln(**);
            end;
     end;
end;
Procedure temas1;
var
   ayud:integer;
begin
     clrscr;
     textcolor(red);
     gotoxy(25,2);
     writeln('Usted esta en configuracion');
     textcolor(11);
     gotoxy(15,5);
     writeln('1.Color de los numeros en el gato');
     gotoxy(15,6);
     writeln('2.Color del marco');
     gotoxy(15,7);
     writeln('3.Color de la pregunta');
     gotoxy(15,8);
     writeln('4.Color de las jugadas');
     gotoxy(15,9);
     writeln('5.Ir a la Ayuda');
     gotoxy(15,10);
     writeln('6.Restablecer valores');
     gotoxy(15,11);
     writeln('7.Salir de la configuracion');
     gotoxy(15,14);
     writeln('Que tema quiere ver');
     gotoxy(15,15);
     writeln('[ ]');
     gotoxy(16,15);
     readln(ayud);
     case  ayud of
           1:begin
                  temacolornumeros;
                  temas1;
            end;
           2:begin
                  colormarco;
                  temas1;
             end;
           3:begin
                  colorpregunta;
                  temas1;
            end;
           4:begin
                  colorjugadaescoger;
                  temas1;
            end;
           5:begin
                  temas;
                  temas1;
            end;
           6:begin
                  numeros:=2;
                  mar:=4;
                  pre:=5;
                  JU1:=8;
                  ju2:=6;
                  temas1;
           end;
           7:begin
                  writeln(**);
           end;
     end;
end;
Procedure marco1;
var
   w,w1,x,x1:integer;
begin
     w:=1;
     x:=1;
     x1:=24;
     w1:=1;
     textcolor(7);
     FOR w:=1 TO 80 DO
      BEGIN
           GOTOXY(w,x);
           WRITE('ß');
           gotoxy(w,x1);
           WRITE('Ü');
      END;
     for x:=1 to 24 do
         begin
              gotoxy(w,x);
              write('Û');
              gotoxy(w1,x);
              write('Û');
         end;
end;
Procedure Marco;
Var
   f,f1,c,c1,c2:integer;
begin
     C2:=27;
     F:=11;
     f1:=15;
     c1:=36;
     textcolor(mar);
     For C:=17 to 46 do
      begin
           GOTOXY(C,F);
           WRITE('Ü');
           gotoxy(c,f1);
           WRITE('Ü');
      end;
     for f:=8 to 19 do
         begin
              gotoxy(c1,f);
              write('Û');
              gotoxy(C2,f);
              write('Û');
         end;
end;
Procedure Ubicar;
begin
     marco;
     textcolor(numeros);
     gotoxy(22,8);
     writeln('1');
     gotoxy(32,8);
     writeln('2');
     gotoxy(42,8);
     writeln('3');
     gotoxy(22,12);
     writeln('4');
     gotoxy(32,12);
     writeln('5');
     gotoxy(42,12);
     writeln('6');
     gotoxy(22,16);
     writeln('7');
     gotoxy(32,16);
     writeln('8');
     gotoxy(42,16);
     writeln('9');
end;
Procedure comprovar;
begin
     textcolor(blue);
     gotoxy(22,10);
     writeln('*');
     gotoxy(32,10);
     writeln('*');
     gotoxy(42,10);
     writeln('*');
     gotoxy(22,14);
     writeln('*');
     gotoxy(32,14);
     writeln('*');
     gotoxy(42,14);
     writeln('*');
     gotoxy(22,18);
     writeln('*');
     gotoxy(32,18);
     writeln('*');
     gotoxy(42,18);
     writeln('*');
end;
Procedure gato;
begin
     marco1;
     comprovar;
     ubicar;
end;
Procedure cargando;
var
   q:integer;
begin
     For q:=10 to 70 do
         begin
              textcolor(9);
              gotoxy(q,20);
              writeln('°');
         end;
end;
Procedure jugadores1;
begin
     clrscr;
     marco1;
     textcolor(9);
     cargando;
     textcolor(14);
     gotoxy(23,6);
     writeln('Digite el nombre de los dos jugadores');
     textcolor(green);
     gotoxy(8,8);
     writeln('El nombre del primer jugador es  ...');
     textcolor(blue);
     gotoxy(41,8);
     readln(Nom1);
     textcolor(green);
     gotoxy(8,10);
     writeln('El nombre del segundo jugador es  ...');
     textcolor(blue);
     gotoxy(42,10);
     readln(Nom2);
end;
Procedure jugadores1compu;
begin
     clrscr;
     marco1;
     textcolor(9);
     cargando;
     textcolor(14);
     gotoxy(23,6);
     writeln('Digite el nombre de los dos jugadores');
     textcolor(green);
     gotoxy(8,8);
     writeln('El nombre del primer jugador es  ...');
     textcolor(blue);
     gotoxy(41,8);
     readln(Nom1);
     nom2:='Compu';
end;
Procedure cargando1;
var
   q,total:integer;
begin
     If (nom1='')and(nom2<>'') then
        begin
             total:=35;
        end;
     If (nom1<>'')and(nom2='') then
        begin
             total:=35;
        end;
     If (nom1='')and(nom2='') then
        begin
             total:=13;
        end;
     If (nom1<>'')and(nom2<>'') then
        begin
             total:=70;
        end;
     If (nom1<>'')and(nom2<>'')and(nom1=nom2) then
        begin
             total:=55;
        end;
     For q:=10 to total do
         begin
              textcolor(14);
              gotoxy(q,20);
              writeln('Û');
              delay(60);

         end;
     If total=70 then
        begin
             textcolor(27);
             gotoxy(18,22);
             writeln('La informacion a sido procesada correctamente');
             delay(2500);
             corre:=1;
        end
     else
         begin
              textcolor(27);
              gotoxy(18,22);
              writeln('Sea encontrado un error en el proceso por favor ');
              gotoxy(18,23);
              writeln('introdusca de nuevo la informaci¢n');
              ayuda;
              gotoxy(65,23);
              readln(ayu);
              If ayu='*' then
                 begin
                      temas;
                 end;
              error:=error+1;
         end;
end;


Procedure llamadocargando;
begin
     textcolor(1);
     gotoxy(18,14);
     writeln('Se esta cargando la informacion de los jugadores');
     cargando1;
end;
procedure info;
begin;
     clrscr;
     marco1;
     textcolor(14);
     gotoxy(32,6);
     writeln('Informaci¢n');
     textcolor(15);
     gotoxy(8,10);
     writeln('El jugador(a) "',nom1,'" jugara con O y el jugador(a) "',nom2,'"jugara con X');
     readkey;
end;
Procedure jugadores;
begin
     jugadores1;
     llamadocargando;
end;
Procedure jugadorescompu;
begin
     jugadores1compu;
     llamadocargando;
end;
procedure compu(var j:integer);
begin
     j:=0;
     {condiciones para ganar}
     if (a3='X')and(a9='X')then
        begin
             if (a6<>'O')and(a6<>'X') then
                begin
                     j:=6;
                     z[34]:=2;
                end;
             if z[34]=1 then
                begin
                     if (a7<>'O')and(a7<>'X') then
                        begin
                             j:=7;
                             z[34]:=2;
                        end;
                end;
        end;
     if (a3='X')and(a7='X')then
        begin
             if (a5<>'O')and(a5<>'X') then
                begin
                     j:=5;
                     z[35]:=2;
                end;
             if z[35]=1 then
                begin
                     if (a9<>'O')and(a9<>'X') then
                        begin
                             j:=9;
                             z[35]:=2;
                        end;
                end;
        end;
     if (a7='X')and(a9='X')then
        begin
             if (a8<>'O')and(a8<>'X') then
                begin
                     j:=8;
                     z[36]:=2;
                end;
             if z[36]=1 then
                begin
                     if (a3<>'O')and(a3<>'X') then
                        begin
                             j:=3;
                             z[36]:=2;
                        end;
                end;
        end;
     if (a9='X')and(a7='X')then
        begin
             if z[37]=1 then
                begin
                     if (a1<>'O')and(a1<>'X') then
                        begin
                             j:=1;
                             z[37]:=2;
                        end;
                end;
        end;
     if (a1='X')and(a9='X')then
        begin
             if (a5<>'O')and(a5<>'X') then
                begin
                     j:=5;
                     z[38]:=2;
                end;
             if z[38]=1 then
                begin
                     if (a7<>'O')and(a7<>'X') then
                        begin
                             j:=7;
                             z[38]:=2;
                        end;
                end;
        end;
     if (a1='X')and(a7='X')then
        begin
             if (a4<>'O')and(a4<>'X') then
                begin
                     j:=4;
                     z[39]:=2;
                end;
             if z[39]=1 then
                begin
                     if (a9<>'O')and(a9<>'X') then
                        begin
                             j:=9;
                             z[39]:=2;
                        end;
                end;
        end;
     if (a7='X')and(a1='X')then
        begin
             if z[40]=1 then
                begin
                     if (a3<>'O')and(a3<>'X') then
                        begin
                             j:=3;
                             z[40]:=2;
                        end;
                end;
        end;
     if (a1='X')and(a3='X')then
        begin
             if (a2<>'O')and(a2<>'X') then
                begin
                     j:=2;
                     z[41]:=2;
                end;
             if z[41]=1 then
                begin
                     if (a7<>'O')and(a7<>'X') then
                        begin
                             j:=7;
                             z[41]:=2;
                        end;
                end;
        end;
     if (a3='X')and(a7='X')then
        begin
             if (a5<>'O')and(a5<>'X') then
                begin
                     j:=5;
                     z[42]:=2;
                end;
             if z[42]=1 then
                begin
                     if (a1<>'O')and(a1<>'X') then
                        begin
                             j:=1;
                             z[42]:=2;
                        end;
                end;
        end;
     if (a1='X')and(a3='X')then
        begin
             if z[43]=1 then
                begin
                     if (a9<>'O')and(a9<>'X') then
                        begin
                             j:=9;
                             z[43]:=2;
                        end;
                end;
        end;
     if (a3='X')and(a9='X')then
        begin
             if z[44]=1 then
                begin
                     if (a1<>'O')and(a1<>'X') then
                        begin
                             j:=1;
                             z[44]:=2;
                        end;
                end;
        end;
     if (a1='X')and(a9='X')then
        begin
             if z[45]=1 then
                begin
                     if (a3<>'O')and(a3<>'X') then
                        begin
                             j:=3;
                             z[45]:=2;
                        end;
                end;
        end;
     if (a4='O')and(a5='O')then
        begin
             if z[12]=1 then
                begin
                     if (a6<>'O')and(a6<>'X') then
                        begin
                             j:=6;
                             z[12]:=2;
                        end;
                end;
        end;
       {CONDICIONESDE BLOQUE DOBLE}
     if (a1='O')and(a2='O')then
        begin
             if z[9]=1 then
                begin
                     if (a3<>'O')and(a3<>'X') then
                        begin
                             j:=3;
                             z[9]:=2;
                        end;
                end;
        end;
    if (a1='O')and(a3='O')then
        begin
             if z[10]=1 then
                begin
                     if (a2<>'O')and(a2<>'X') then
                        begin
                             j:=2;
                             z[10]:=2;
                        end;
                end;
        end;
    if (a2='O')and(a3='O')then
        begin
             if z[11]=1 then
                begin
                     if (a1<>'O')and(a1<>'X') then
                        begin
                             j:=1;
                             z[11]:=2;
                        end;
                end;
        end;

    if (a4='O')and(a6='O')then
        begin
             if z[13]=1 then
                begin
                     if (a5<>'O')and(a5<>'X') then
                        begin
                             j:=5;
                             z[13]:=2;
                        end;
                end;
        end;
    if (a5='O')and(a6='O')then
        begin
             if z[14]=1 then
                begin
                     if (a4<>'O')and(a4<>'X') then
                        begin
                             j:=4;
                             z[14]:=2;
                        end;
                end;
        end;
    if (a7='O')and(a8='O')then
        begin
             if z[15]=1 then
                begin
                     if (a9<>'O')and(a9<>'X') then
                        begin
                             j:=9;
                             z[15]:=2;
                        end;
                end;
        end;
    if (a7='O')and(a9='O')then
        begin
             if z[16]=1 then
                begin
                     if (a8<>'O')and(a8<>'X') then
                        begin
                             j:=8;
                             z[16]:=2;
                        end;
                end;
        end;
    if (a8='O')and(a9='O')then
        begin
             if z[17]=1 then
                begin
                     if (a7<>'O')and(a7<>'X') then
                        begin
                             j:=7;
                             z[17]:=2;
                        end;
                end;
        end;
    if (a1='O')and(a4='O')then
        begin
             if z[18]=1 then
                begin
                     if (a7<>'O')and(a7<>'X') then
                        begin
                             j:=7;
                             z[18]:=2;
                        end;
                end;
        end;
    if (a1='O')and(a7='O')then
        begin
             if z[19]=1 then
                begin
                     if (a4<>'O')and(a4<>'X') then
                        begin
                             j:=4;
                             z[19]:=2;
                        end;
                end;
        end;
    if (a4='O')and(a7='O')then
        begin
             if z[20]=1 then
                begin
                     if (a1<>'O')and(a1<>'X') then
                        begin
                             j:=1;
                             z[20]:=2;
                        end;
                end;
        end;
    if (a2='O')and(a5='O')then
        begin
             if z[21]=1 then
                begin
                     if (a8<>'O')and(a8<>'X') then
                        begin
                             j:=8;
                             z[21]:=2;
                        end;
                end;
        end;
    if (a2='O')and(a8='O')then
        begin
             if z[22]=1 then
                begin
                     if (a5<>'O')and(a5<>'X') then
                        begin
                             j:=5;
                             z[22]:=2;
                        end;
                end;
        end;
    if (a5='O')and(a8='O')then
        begin
             if z[23]=1 then
                begin
                     if (a2<>'O')and(a2<>'X') then
                        begin
                             j:=2;
                             z[23]:=2;
                        end;
                end;
        end;
    if (a3='O')and(a6='O')then
        begin
             if z[24]=1 then
                begin
                     if (a9<>'O')and(a9<>'X') then
                        begin
                             j:=9;
                             z[24]:=2;
                        end;
                end;
        end;
    if (a3='O')and(a9='O')then
        begin
             if z[25]=1 then
                begin
                     if (a6<>'O')and(a6<>'X') then
                        begin
                             j:=6;
                             z[25]:=2;
                        end;
                end;
        end;
    if (a6='O')and(a9='O')then
        begin
             if z[26]=1 then
                begin
                     if (a9<>'O')and(a9<>'X') then
                        begin
                             j:=9;
                             z[26]:=2;
                        end;
                end;
        end;
    if (a1='O')and(a5='O')then
        begin
             if z[27]=1 then
                begin
                     if (a9<>'O')and(a9<>'X') then
                        begin
                             j:=9;
                             z[27]:=2;
                        end;
                end;
        end;
    if (a1='O')and(a9='O')then
        begin
             if z[28]=1 then
                begin
                     if (a5<>'O')and(a5<>'X') then
                        begin
                             j:=5;
                             z[28]:=2;
                        end;
                end;
        end;
    if (a5='O')and(a9='O')then
        begin
             if z[29]=1 then
                begin
                     if (a1<>'O')and(a1<>'X') then
                        begin
                             j:=1;
                             z[29]:=2;
                        end;
                end;
        end;
    if (a3='O')and(a5='O')then
        begin
             if z[30]=1 then
                begin
                     if (a7<>'O')and(a7<>'X') then
                        begin
                             j:=7;
                             z[30]:=2;
                        end;
                end;
        end;
    if (a3='O')and(a7='O')then
        begin
             if z[31]=1 then
                begin
                     if (a5<>'O')and(a5<>'X') then
                        begin
                             j:=5;
                             z[31]:=2;
                        end;
                end;
        end;
    if (a3='O')and(a5='O')then
        begin
             if z[32]=1 then
                begin
                     if (a7<>'O')and(a7<>'X') then
                        begin
                             j:=7;
                             z[32]:=2;
                        end;
                end;
        end;
      {condisiones para bloquerar}
  if j=0 then
   begin

     if a1='O'then
        begin
             if z[33]=1 then
                begin
                     if (a3<>'O')and(a3<>'X') then
                        begin
                             j:=3;
                             z[33]:=2;
                        end
                     else
                         begin
                              if (a9<>'O')and(a9<>'X')then
                                 begin
                                      j:=9;
                                      z[33]:=2;
                                 end
                              else
                                  begin
                                       if (a7<>'O')and(a7<>'X')then
                                          begin
                                               j:=7;
                                               z[33]:=2;
                                          end
                                       else
                                           begin
                                                if (a4<>'O')and(a4<>'X')then
                                                   begin
                                                        j:=4;
                                                        z[33]:=2;
                                                   end
                                                else
                                                    begin
                                                        
if(a2<>'O')and(a2<>'X')then
                                                            begin
                                                                 j:=2;
                                                                 z[33]:=2;
                                                            end
                                                         else
                                                             begin
                                                                  if
(a5<>'O')and(a5<>'X')then
                                                                     begin
                                                                          j:=5;
                                                                         
z[33]:=2;
                                                                     end
                                                                  else
                                                                      begin
                                                                           if
(a8<>'O')and(a8<>'X')then
                                                                             
begin
                                                                                  
j:=8;
                                                                                  
z[33]:=2;
                                                                             
end
                                                                           else
                                                                              
begin
                                                                                   
if (a6<>'O')and(a6<>'X')then
                                                                                      
begin
                                                                                           
j:=6;
                                                                                           
z[33]:=2;
                                                                                      
end;
                                                                              
end;
                                                                      end;
                                                             end;
                                                    end;
                                           end;
                                  end;
                         end;
                end;
        end;
     if a2='O'then
        begin
             if z[3]=1 then
                begin
                     if (a3<>'O')and(a3<>'X') then
                        begin
                             j:=3;
                             z[3]:=2;
                        end
                     else
                         begin
                              if (a9<>'O')and(a9<>'X')then
                                 begin
                                      j:=9;
                                      z[3]:=2;
                                 end
                              else
                                  begin
                                       if (a7<>'O')and(a7<>'X')then
                                          begin
                                               j:=7;
                                               z[3]:=2;
                                          end
                                       else
                                           begin
                                                if (a1<>'O')and(a1<>'X')then
                                                   begin
                                                        j:=1;
                                                        z[3]:=2;
                                                   end
                                                else
                                                    begin
                                                        
if(a4<>'O')and(a4<>'X')then
                                                            begin
                                                                 j:=4;
                                                                 z[3]:=2;
                                                            end
                                                         else
                                                             begin
                                                                  if
(a5<>'O')and(a5<>'X')then
                                                                     begin
                                                                          j:=5;
                                                                         
z[3]:=2;
                                                                     end
                                                                  else
                                                                      begin
                                                                           if
(a8<>'O')and(a8<>'X')then
                                                                             
begin
                                                                                  
j:=8;
                                                                                  
z[3]:=2;
                                                                             
end
                                                                           else
                                                                              
begin
                                                                                   
if (a6<>'O')and(a6<>'X')then
                                                                                      
begin
                                                                                           
j:=6;
                                                                                           
z[3]:=2;
                                                                                      
end;
                                                                              
end;
                                                                      end;
                                                             end;
                                                    end;
                                           end;
                                  end;
                         end;
                end;
        end;
     if a3='O'then
        begin
             if z[1]=1 then
                begin
                     if (a7<>'O')and(a7<>'X') then
                        begin
                             j:=7;
                             z[1]:=2;
                        end
                     else
                         begin
                              if (a9<>'O')and(a9<>'X')then
                                 begin
                                      j:=9;
                                      z[1]:=2;
                                 end
                              else
                                  begin
                                       if (a4<>'O')and(a4<>'X')then
                                          begin
                                               j:=4;
                                               z[1]:=2;
                                          end
                                       else
                                           begin
                                                if (a1<>'O')and(a1<>'X')then
                                                   begin
                                                        j:=1;
                                                        z[1]:=2;
                                                   end
                                                else
                                                    begin
                                                        
if(a2<>'O')and(a2<>'X')then
                                                            begin
                                                                 j:=2;
                                                                 z[1]:=2;
                                                            end
                                                         else
                                                             begin
                                                                  if
(a5<>'O')and(a5<>'X')then
                                                                     begin
                                                                          j:=5;
                                                                         
z[1]:=2;
                                                                     end
                                                                  else
                                                                      begin
                                                                           if
(a8<>'O')and(a8<>'X')then
                                                                             
begin
                                                                                  
j:=8;
                                                                                  
z[1]:=2;
                                                                             
end
                                                                           else
                                                                              
begin
                                                                                   
if (a6<>'O')and(a6<>'X')then
                                                                                      
begin
                                                                                           
j:=6;
                                                                                           
z[1]:=2;
                                                                                      
end;
                                                                              
end;
                                                                      end;
                                                             end;
                                                    end;
                                           end;
                                  end;
                         end;
                end;
        end;
     if a4='O'then
        begin
             if z[2]=1 then
                begin
                     if (a3<>'O')and(a3<>'X') then
                        begin
                             j:=3;
                             z[2]:=2;
                        end
                     else
                         begin
                              if (a9<>'O')and(a9<>'X')then
                                 begin
                                      j:=9;
                                      z[2]:=2;
                                 end
                              else
                                  begin
                                       if (a7<>'O')and(a7<>'X')then
                                          begin
                                               j:=7;
                                               z[2]:=2;
                                          end
                                       else
                                           begin
                                                if (a1<>'O')and(a1<>'X')then
                                                   begin
                                                        j:=1;
                                                        z[2]:=2;
                                                   end
                                                else
                                                    begin
                                                        
if(a2<>'O')and(a2<>'X')then
                                                            begin
                                                                 j:=2;
                                                                 z[2]:=2;
                                                            end
                                                         else
                                                             begin
                                                                  if
(a5<>'O')and(a5<>'X')then
                                                                     begin
                                                                          j:=5;
                                                                         
z[2]:=2;
                                                                     end
                                                                  else
                                                                      begin
                                                                           if
(a8<>'O')and(a8<>'X')then
                                                                             
begin
                                                                                  
j:=8;
                                                                                  
z[2]:=2;
                                                                             
end
                                                                           else
                                                                              
begin
                                                                                   
if (a6<>'O')and(a6<>'X')then
                                                                                      
begin
                                                                                           
j:=6;
                                                                                           
z[2]:=2;
                                                                                      
end;
                                                                              
end;
                                                                      end;
                                                             end;
                                                    end;
                                           end;
                                  end;
                         end;
                end;
        end;
    if a5='O'then
        begin
             if z[4]=1 then
                begin
                     if (a3<>'O')and(a3<>'X') then
                        begin
                             j:=3;
                             z[4]:=2;
                        end
                     else
                         begin
                              if (a9<>'O')and(a9<>'X')then
                                 begin
                                      j:=9;
                                      z[4]:=2;
                                 end
                              else
                                  begin
                                       if (a7<>'O')and(a7<>'X')then
                                          begin
                                               j:=7;
                                               z[4]:=2;
                                          end
                                       else
                                           begin
                                                if (a1<>'O')and(a1<>'X')then
                                                   begin
                                                        j:=1;
                                                        z[4]:=2;
                                                   end
                                                else
                                                    begin
                                                        
if(a2<>'O')and(a2<>'X')then
                                                            begin
                                                                 j:=2;
                                                                 z[4]:=2;
                                                            end
                                                         else
                                                             begin
                                                                  if
(a4<>'O')and(a4<>'X')then
                                                                     begin
                                                                          j:=5;
                                                                         
z[4]:=2;
                                                                     end
                                                                  else
                                                                      begin
                                                                           if
(a8<>'O')and(a8<>'X')then
                                                                             
begin
                                                                                  
j:=8;
                                                                                  
z[4]:=2;
                                                                             
end
                                                                           else
                                                                              
begin
                                                                                   
if (a6<>'O')and(a6<>'X')then
                                                                                      
begin
                                                                                           
j:=6;
                                                                                           
z[4]:=2;
                                                                                      
end;
                                                                              
end;
                                                                      end;
                                                             end;
                                                    end;
                                           end;
                                  end;
                         end;
                end;
        end;
    if a6='O'then
        begin
             if z[5]=1 then
                begin
                     if (a3<>'O')and(a3<>'X') then
                        begin
                             j:=3;
                             z[5]:=2;
                        end
                     else
                         begin
                              if (a9<>'O')and(a9<>'X')then
                                 begin
                                      j:=9;
                                      z[5]:=2;
                                 end
                              else
                                  begin
                                       if (a7<>'O')and(a7<>'X')then
                                          begin
                                               j:=7;
                                               z[5]:=2;
                                          end
                                       else
                                           begin
                                                if (a1<>'O')and(a1<>'X')then
                                                   begin
                                                        j:=1;
                                                        z[5]:=2;
                                                   end
                                                else
                                                    begin
                                                        
if(a2<>'O')and(a2<>'X')then
                                                            begin
                                                                 j:=2;
                                                                 z[5]:=2;
                                                            end
                                                         else
                                                             begin
                                                                  if
(a5<>'O')and(a5<>'X')then
                                                                     begin
                                                                          j:=5;
                                                                         
z[5]:=2;
                                                                     end
                                                                  else
                                                                      begin
                                                                           if
(a8<>'O')and(a8<>'X')then
                                                                             
begin
                                                                                  
j:=8;
                                                                                  
z[5]:=5;
                                                                             
end
                                                                           else
                                                                              
begin
                                                                                   
if (a4<>'O')and(a4<>'X')then
                                                                                      
begin
                                                                                           
j:=4;
                                                                                           
z[5]:=2;
                                                                                      
end;
                                                                              
end;
                                                                      end;
                                                             end;
                                                    end;
                                           end;
                                  end;
                         end;
                end;
        end;
    if a7='O'then
        begin
             if z[6]=1 then
                begin
                     if (a3<>'O')and(a3<>'X') then
                        begin
                             j:=3;
                             z[6]:=2;
                        end
                     else
                         begin
                              if (a9<>'O')and(a9<>'X')then
                                 begin
                                      j:=9;
                                      z[6]:=2;
                                 end
                              else
                                  begin
                                       if (a4<>'O')and(a4<>'X')then
                                          begin
                                               j:=4;
                                               z[6]:=2;
                                          end
                                       else
                                           begin
                                                if (a1<>'O')and(a1<>'X')then
                                                   begin
                                                        j:=1;
                                                        z[6]:=2;
                                                   end
                                                else
                                                    begin
                                                        
if(a2<>'O')and(a2<>'X')then
                                                            begin
                                                                 j:=2;
                                                                 z[6]:=2;
                                                            end
                                                         else
                                                             begin
                                                                  if
(a5<>'O')and(a5<>'X')then
                                                                     begin
                                                                          j:=5;
                                                                         
z[6]:=2;
                                                                     end
                                                                  else
                                                                      begin
                                                                           if
(a8<>'O')and(a8<>'X')then
                                                                             
begin
                                                                                  
j:=8;
                                                                                  
z[6]:=5;

end
                                                                           else
                                                                              
begin
                                                                                   
if (a4<>'O')and(a4<>'X')then
                                                                                      
begin
                                                                                           
j:=4;
                                                                                           
z[6]:=2;
                                                                                      
end;
                                                                              
end;
                                                                      end;
                                                             end;
                                                    end;
                                           end;
                                  end;
                         end;
                end;
        end;
    if a8='O'then
        begin
             if z[7]=1 then
                begin
                     if (a3<>'O')and(a3<>'X') then
                        begin
                             j:=3;
                             z[7]:=2;
                        end
                     else
                         begin
                              if (a9<>'O')and(a9<>'X')then
                                 begin
                                      j:=9;
                                      z[7]:=2;
                                 end
                              else
                                  begin
                                       if (a7<>'O')and(a7<>'X')then
                                          begin
                                               j:=7;
                                               z[7]:=2;
                                          end
                                       else
                                           begin
                                                if (a1<>'O')and(a1<>'X')then
                                                   begin
                                                        j:=1;
                                                        z[7]:=2;
                                                   end
                                                else
                                                    begin
                                                        
if(a2<>'O')and(a2<>'X')then
                                                            begin
                                                                 j:=2;
                                                                 z[7]:=2;
                                                            end
                                                         else
                                                             begin
                                                                  if
(a5<>'O')and(a5<>'X')then
                                                                     begin
                                                                          j:=5;
                                                                         
z[7]:=2;
                                                                     end
                                                                  else
                                                                      begin
                                                                           if
(a4<>'O')and(a4<>'X')then
                                                                             
begin
                                                                                  
j:=8;

z[7]:=5;
                                                                             
end
                                                                           else
                                                                              
begin
                                                                                   
if (a4<>'O')and(a4<>'X')then
                                                                                      
begin
                                                                                           
j:=4;
                                                                                           
z[7]:=2;
                                                                                      
end;
                                                                              
end;
                                                                      end;
                                                             end;
                                                    end;
                                           end;
                                  end;
                         end;
                end;
        end;
    if a9='O'then
        begin
             if z[8]=1 then
                begin
                     if (a3<>'O')and(a3<>'X') then
                        begin
                             j:=3;
                             z[8]:=2;
                        end
                     else
                         begin
                              if (a4<>'O')and(a4<>'X')then
                                 begin
                                      j:=4;
                                      z[8]:=2;
                                 end
                              else
                                  begin
                                       if (a7<>'O')and(a7<>'X')then
                                          begin
                                               j:=7;
                                               z[8]:=2;
                                          end
                                       else
                                           begin
                                                if (a1<>'O')and(a1<>'X')then
                                                   begin
                                                        j:=1;
                                                        z[8]:=2;
                                                   end
                                                else
                                                    begin
                                                        
if(a2<>'O')and(a2<>'X')then
                                                            begin
                                                                 j:=2;
                                                                 z[8]:=2;
                                                            end
                                                         else
                                                             begin
                                                                  if
(a5<>'O')and(a5<>'X')then
                                                                     begin
                                                                          j:=5;
                                                                         
z[8]:=2;
                                                                     end
                                                                  else
                                                                      begin
                                                                           if
(a8<>'O')and(a8<>'X')then
                                                                             
begin

j:=8;
                                                                                  
z[8]:=5;
                                                                             
end
                                                                           else
                                                                              
begin
                                                                                   
if (a4<>'O')and(a4<>'X')then
                                                                                      
begin
                                                                                           
j:=4;
                                                                                           
z[8]:=2;
                                                                                      
end;
                                                                              
end;
                                                                      end;
                                                             end;
                                                    end;
                                           end;
                                  end;
                         end;
                end;
        end;

  end;
end;

Procedure gano(var a1,a2,a3,a4,a5,a6,a7,a8,a9:char;var j,t:integer);
var
   f,f1,c1:integer;
begin
     letra1:='X';
     letra2:='O';
     If J=1 then
        begin
             If (C mod 2=0) then
                begin
                     gotoxy(22,10);
                     textcolor(ju2);
                     writeln('X');
                     a1:=letra1;
                end
             else
                 begin
                      gotoxy(22,10);
                      textcolor(ju1);
                      writeln('O');
                      a1:=letra2;
                 end;
        end;
     If J=2 then
        begin
             If (C mod 2=0) then
                begin
                     gotoxy(32,10);
                     textcolor(ju2);
                     writeln('X');
                     a2:=letra1;
                end
             else
                 begin
                      gotoxy(32,10);
                      textcolor(ju1);
                      writeln('O');
                      a2:=letra2;
                 end;
        end;
     If J=3 then
        begin
             If (C mod 2=0) then
                begin
                     gotoxy(42,10);
                     textcolor(ju2);
                     writeln('X');
                     a3:=letra1;
                end
             else
                 begin
                      gotoxy(42,10);
                      textcolor(ju1);
                      writeln('O');
                      a3:=letra2;
                 end;
        end;
     If J=4 then
        begin
             If (C mod 2=0) then
                begin
                     gotoxy(22,14);
                     textcolor(ju2);
                     writeln('X');
                     a4:=letra1;
                end
             else
                 begin
                      gotoxy(22,14);
                      textcolor(ju1);
                      writeln('O');
                      a4:=letra2;
                 end;
        end;
     If J=5 then
        begin
             If (C mod 2=0) then
                begin
                     gotoxy(32,14);
                     textcolor(ju2);
                     writeln('X');
                     a5:=letra1;
                end
             else
                 begin
                      gotoxy(32,14);
                      textcolor(ju1);
                      writeln('O');
                      a5:=letra2;
                 end;
        end;
     If J=6 then
        begin
             If (C mod 2=0) then
                begin
                     gotoxy(42,14);
                     textcolor(ju2);
                     writeln('X');
                     a6:=letra1;
                end
             else
                 begin
                      gotoxy(42,14);
                      textcolor(ju1);
                      writeln('O');
                      a6:=letra2;
                 end;
        end;
     If J=7 then
        begin
             If (C mod 2=0) then
                begin
                     gotoxy(22,18);
                     textcolor(ju2);
                     writeln('X');
                     a7:=letra1;
                end
             else
                 begin
                      gotoxy(22,18);
                      textcolor(ju1);
                      writeln('O');
                      a7:=letra2;
                 end;
        end;
     If J=8 then
        begin
             If (C mod 2=0) then
                begin
                     gotoxy(32,18);
                     textcolor(ju2);
                     writeln('X');
                     a8:=letra1;
                end
             else
                 begin
                      gotoxy(32,18);
                      textcolor(ju1);
                      writeln('O');
                      a8:=letra2;
                 end;
        end;
     If J=9 then
        begin
             If (C mod 2=0) then
                begin
                     gotoxy(42,18);
                     textcolor(ju2);
                     writeln('X');
                     a9:=letra1;
                end
             else
                 begin
                      gotoxy(42,18);
                      textcolor(ju1);
                      writeln('O');
                      a9:=letra2;
                 end;
        end;
     {linea para x}
     If (A1=LETRA1)AND(a2=LETRA1)AND(a3=LETRA1) then
        begin
             For c:=22 to 42 do
                 begin
                      textcolor(blue);
                      gotoxy(c,10);
                      writeln('ß');
                      GOTOXY(20,22);
                      textcolor(30);
                      WRITELN ('El jugador ',nom2,' GANO el juego');
                      Q:=9;
                      delay(50);
                      t:=10;
                 end;
             readkey;
        end;
     IF (a4=LETRA1)AND(a5=LETRA1)AND(a6=LETRA1) then
        begin
             For c:=22 to 42 do
                 begin
                      textcolor(blue);
                      gotoxy(c,14);
                      writeln('ß');
                      GOTOXY(20,22);
                      textcolor(30);
                      WRITELN ('El jugador ',nom2,' GANO el juego');
                      Q:=9;
                      delay(50);
                      t:=10;
                 end;
             readkey;
        end;
     IF (a7=LETRA1)AND(a8=LETRA1)AND(a9=LETRA1) then
        begin
             For c:=22 to 42 do
                 begin
                      textcolor(blue);
                      gotoxy(c,18);
                      writeln('ß');
                      GOTOXY(20,22);
                      textcolor(30);
                      WRITELN ('El jugador ',nom2,' GANO el juego');
                      Q:=9;
                      delay(50);
                      t:=10;
                 end;
             readkey;
        end;
     IF (a1=LETRA1)AND(a4=LETRA1)AND(a7=LETRA1) then
        begin
             For f:=10 to 18 do
                 begin
                      textcolor(blue);
                      gotoxy(22,f);
                      writeln('Û');
                      GOTOXY(20,22);
                      textcolor(30);
                      WRITELN ('El jugador ',nom2,' GANO el juego');
                      Q:=9;
                      delay(50);
                      t:=10;
                 end;
             readkey;
        end;
     IF (a2=LETRA1)AND(a5=LETRA1)AND(a8=LETRA1) then
        begin
             For f:=10 to 18 do
                 begin
                      textcolor(blue);
                      gotoxy(32,f);
                      writeln('Û');
                      GOTOXY(20,22);
                      textcolor(30);
                      WRITELN ('El jugador ',nom2,' GANO el juego');
                      Q:=9;
                      delay(50);
                      t:=10;
                 end;
             readkey;
        end;
     IF (a3=LETRA1)AND(a6=LETRA1)AND(a9=LETRA1) then
        begin
             For f:=10 to 18 do
                 begin
                      textcolor(blue);
                      gotoxy(42,f);
                      writeln('Û');
                      GOTOXY(20,22);
                      textcolor(30);
                      WRITELN ('El jugador ',nom2,' GANO el juego');
                      Q:=9;
                      delay(50);
                      t:=10;
                 end;
             readkey;
        end;
     If (a1=LETRA1)AND(a5=LETRA1)AND(a9=LETRA1) then
        begin
             c:=24;
             f:=10;
             p1:=0;
             repeat
                      textcolor(blue);
                      gotoxy(c,f);
                      writeln('ÛÛ');
                      GOTOXY(20,22);
                      textcolor(30);
                      WRITELN ('El jugador ',nom2,' GANO el juego');
                      Q:=9;
                      delay(50);
                      c:=c+2;
                      f:=f+1;
                      p1:=p1+1;
             until p1=9;
             readkey;
             t:=10;
        end;
     If (a3=LETRA1)AND(a5=LETRA1)AND(a7=LETRA1) then
        begin
             c:=40;
             f:=10;
             p1:=0;
             repeat
                      textcolor(blue);
                      gotoxy(c,f);
                      writeln('ÛÛ');
                      GOTOXY(20,22);
                      textcolor(30);
                      WRITELN ('El jugador ',nom2,' GANO el juego');
                      Q:=9;
                      delay(50);
                      c:=c-2;
                      f:=f+1;
                      p1:=p1+1;
             until p1=9;
             readkey;
             t:=10;
        end;
     {LINEA PARA O}
     If (A1=LETRA2)AND(a2=LETRA2)AND(a3=LETRA2) then
        begin
             For c:=22 to 42 do
                 begin
                      textcolor(blue);
                      gotoxy(c,10);
                      writeln('ß');
                      GOTOXY(20,22);
                      textcolor(30);
                      WRITELN ('El jugador ',nom1,' GANO el juego');
                      Q:=9;
                      delay(50);
                      t:=10;
                 end;
             readkey;
        end;
     IF (a4=LETRA2)AND(a5=LETRA2)AND(a6=LETRA2) then
        begin
             For c:=22 to 42 do
                 begin
                      textcolor(blue);
                      gotoxy(c,14);
                      writeln('ß');
                      GOTOXY(20,22);
                      textcolor(30);
                      WRITELN ('El jugador ',nom1,' GANO el juego');
                      Q:=9;
                      delay(50);
                      t:=10;
                 end;
             readkey;
        end;
     IF (a7=LETRA2)AND(a8=LETRA2)AND(a9=LETRA2) then
        begin
             For c:=22 to 42 do
                 begin
                      textcolor(blue);
                      gotoxy(c,18);
                      writeln('ß');
                      GOTOXY(20,22);
                      textcolor(30);
                      WRITELN ('El jugador ',nom1,' GANO el juego');
                      Q:=9;
                      delay(50);
                      t:=10;
                 end;
             readkey;
        end;
     IF (a1=LETRA2)AND(a4=LETRA2)AND(a7=LETRA2) then
        begin
             For f:=10 to 18 do
                 begin
                      textcolor(blue);
                      gotoxy(22,f);
                      writeln('Û');
                      GOTOXY(20,22);
                      textcolor(30);
                      WRITELN ('El jugador ',nom1,' GANO el juego');
                      Q:=9;
                      delay(50);
                      t:=10;
                 end;
             readkey;
        end;
     IF (a2=LETRA2)AND(a5=LETRA2)AND(a8=LETRA2) then
        begin
             For f:=10 to 18 do
                 begin
                      textcolor(blue);
                      gotoxy(32,f);
                      writeln('Û');
                      GOTOXY(20,22);
                      textcolor(30);
                      WRITELN ('El jugador ',nom1,' GANO el juego');
                      Q:=9;
                      delay(50);
                      t:=10;
                 end;
             readkey;
        end;
     IF (a3=LETRA2)AND(a6=LETRA2)AND(a9=LETRA2) then
        begin
             For f:=10 to 18 do
                 begin
                      textcolor(blue);
                      gotoxy(42,f);
                      writeln('Û');
                      GOTOXY(20,22);
                      textcolor(30);
                      WRITELN ('El jugador ',nom1,' GANO el juego');
                      Q:=9;
                      delay(50);
                      t:=10;
                 end;
             readkey;
        end;
     If (a1=LETRA2)AND(a5=LETRA2)AND(a9=LETRA2) then
        begin
             c1:=24;
             f1:=10;
             p1:=0;
             repeat
                      textcolor(blue);
                      gotoxy(c1,f1);
                      writeln('ÛÛ');
                      GOTOXY(20,22);
                      textcolor(30);
                      WRITELN ('El jugador ',nom1,' GANO el juego');
                      Q:=9;
                      delay(50);
                      c1:=c1+2;
                      f1:=f1+1;
                      p1:=p1+1;
             until p1=9;
             readkey;
             t:=10;
        end;
     If (a3=LETRA2)AND(a5=LETRA2)AND(a7=LETRA2) then
        begin
             c1:=40;
             f1:=10;
             p1:=0;
             repeat
                      textcolor(blue);
                      gotoxy(c1,f1);
                      writeln('ÛÛ');
                      GOTOXY(20,22);
                      textcolor(30);
                      WRITELN ('El jugador ',nom1,' GANO el juego');
                      Q:=9;
                      delay(50);
                      c1:=c1-2;
                      f1:=f1+1;
                      p1:=p1+1;
             until p1=9;
             readkey;
             t:=10;
        end;
end;
Procedure reubicar;
begin
     textcolor(blue);
     If (a1=letra1) then
        begin
             gotoxy(22,10);
             textcolor(ju2);
             writeln(a1);
        end
     else
         begin
             gotoxy(22,10);
             textcolor(ju1);
             writeln(a1);
         end;
     If a2=letra1 then
        begin
             gotoxy(32,10);
             textcolor(ju2);
             writeln(a2);
        end
     else
         begin
              gotoxy(32,10);
             textcolor(ju1);
             writeln(a2);
         end;
     If a3=letra1 then
        begin
             gotoxy(42,10);
             textcolor(ju2);
             writeln(a3);
        end
     else
         begin
             gotoxy(42,10);
             textcolor(ju1);
             writeln(a3);
         end;
     If a4=letra1 then
        begin
             textcolor(ju2);
             gotoxy(22,14);
             writeln(a4);
        end
     else
         begin
             textcolor(ju1);
             gotoxy(22,14);
             writeln(a4);
         end;
     If a5=letra1 then
        begin
             textcolor(ju2);
             gotoxy(32,14);
             writeln(a5);
        end
     else
         begin
             textcolor(ju1);
             gotoxy(32,14);
             writeln(a5);
         end;
     If a6=letra1 then
        begin
             textcolor(ju2);
             gotoxy(42,14);
             writeln(a6);
        end
     else
         begin
             textcolor(ju1);
             gotoxy(42,14);
             writeln(a6);
         end;
     if a7=letra1 then
        begin
             textcolor(ju2);
             gotoxy(22,18);
             writeln(a7);
        end
     else
         begin
             textcolor(ju1);
             gotoxy(22,18);
             writeln(a7);
         end;
     If a8=letra1 then
        begin
             textcolor(ju2);
             gotoxy(32,18);
             writeln(a8);
         end
     else
         begin
             textcolor(ju1);
             gotoxy(32,18);
             writeln(a8);
         end;
     if a9=letra1 then
        begin
             textcolor(ju2);
             gotoxy(42,18);
             writeln(a9);
        end
     else
         begin
              textcolor(ju1);
             gotoxy(42,18);
             writeln(a9);
         end;
     If a1='*' then
        begin
             gotoxy(22,10);
             textcolor(1);
             writeln(a1);
        end;
     if a2='*'then
        begin
             gotoxy(32,10);
             textcolor(1);
             writeln(a2);
        end;
     if a3='*' then
        begin
             gotoxy(42,10);
             textcolor(1);
             writeln(a3);
        end;
     If a4='*' then
        begin
             textcolor(1);
             gotoxy(22,14);
             writeln(a4);
        end;
     If a5='*' then
        begin
             textcolor(1);
             gotoxy(32,14);
             writeln(a5);
        end;
     If a6='*' then
        begin
             textcolor(1);
             gotoxy(42,14);
             writeln(a6);
        end;
     If a7='*' then
        begin
             textcolor(1);
             gotoxy(22,18);
             writeln(a7);
        end;
     if a8='*' then
        begin
             textcolor(1);
             gotoxy(32,18);
             writeln(a8);
        end;
     If a9='*' then
        begin
             textcolor(1);
             gotoxy(42,18);
             writeln(a9);
        end;
end;
Procedure Jugada(var j:integer;var c:integer);
begin
     ayuda1;
     configuracion;
     salirfin;
     If c mod 2=0 then
        begin
             textcolor(pre);
             gotoxy(3,3);
             clreol;
             gotoxy(3,3);
             writeln('La jugada de ',nom1,' es');
             gotoxy(3,5);
             clreol;
             gotoxy(3,6);
             clreol;
             gotoxy(3,7);
             clreol;
             gotoxy(3,4);
             clreol;
             marco1;
             gotoxy(3,4);
             readln(J);
             If j=00 then
                begin
                     temas1;
                     clrscr;
                     gato;
                     reubicar;
                     Jugada(j,c);
                     c:=c-1;
                end;
             if j<1 then
                begin
                     gotoxy(3,6);
                     writeln('Solo son numeros positivos');
                     delay(900);
                     Jugada(j,c);
                     c:=c-1;
                end;
             If j=99 then
                begin
                     temas;
                     clrscr;
                     gato;
                     reubicar;
                     Jugada(j,c);
                     c:=c-1;
                end;
             If (j>9)and(j<>55) then
                begin
                     gotoxy(3,6);
                     writeln('Escriba un solo digito');
                     delay(900);
                     Jugada(j,c);
                     c:=c-1;
                end;
             c:=c+1;
        end
     Else
         begin
              textcolor(pre);
              gotoxy(3,3);
              clreol;
              gotoxy(3,3);
              writeln('La jugada de ',nom2,' es');
              gotoxy(3,5);
              clreol;
              gotoxy(3,6);
              clreol;
              gotoxy(3,7);
              clreol;
              gotoxy(3,4);
              clreol;
              gotoxy(3,4);
              marco1;
              gotoxy(3,4);
              readln(J);
              If j=00 then
                begin
                     temas1;
                     clrscr;
                     gato;
                     reubicar;
                     Jugada(j,c);
                     c:=c-1;
                end;
              if j<1 then
                begin
                     gotoxy(3,6);
                     writeln('Solo son numeros positivos');
                     delay(900);
                     Jugada(j,c);
                     c:=c-1;
                end;
              If j=99 then
                begin
                     temas;
                     clrscr;
                     gato;
                     reubicar;
                     Jugada(j,c);
                     c:=c-1;
                end;
              If (j>9)and(j<>55) then
                begin
                     gotoxy(3,6);
                     writeln('Escriba un solo digito');
                     delay(900);
                     Jugada(j,c);
                     c:=c-1;
                end;
              c:=c+1;
         end;
end;
Procedure Jugadaconcompu(var j:integer;var c:integer);
begin
     ayuda1;
     configuracion;
     salirfin;
     If c mod 2=0 then
        begin
             textcolor(pre);
             gotoxy(3,3);
             clreol;
             gotoxy(3,3);
             writeln('La jugada de ',nom1,' es');
             gotoxy(3,5);
             clreol;
             gotoxy(3,6);
             clreol;
             gotoxy(3,7);
             clreol;
             gotoxy(3,4);
             clreol;
             marco1;
             gotoxy(3,4);
             readln(J);
             If j=00 then
                begin
                     temas1;
                     clrscr;
                     gato;
                     reubicar;
                     Jugada(j,c);
                     c:=c-1;
                end;
             if j<1 then
                begin
                     gotoxy(3,6);
                     writeln('Solo son numeros positivos');
                     delay(900);
                     Jugada(j,c);
                     c:=c-1;
                end;
             If j=99 then
                begin
                     temas;
                     clrscr;
                     gato;
                     reubicar;
                     Jugada(j,c);
                     c:=c-1;
                end;
             If (j>9)and(j<>55) then
                begin
                     gotoxy(3,6);
                     writeln('Escriba un solo digito');
                     delay(900);
                     Jugada(j,c);
                     c:=c-1;
                end;
             c:=c+1;
        end
     Else
         begin
              textcolor(pre);
              gotoxy(3,3);
              clreol;
              gotoxy(3,3);
              writeln('La jugada de compu es');
              gotoxy(3,5);
              clreol;
              gotoxy(3,6);
              clreol;
              gotoxy(3,7);
              clreol;
              gotoxy(3,4);
              clreol;
              gotoxy(3,4);
              marco1;
              gotoxy(3,4);
              delay(250);
              compu(j);
              delay(350);
              c:=c+1;
         end;
end;

Procedure movida(var j:integer);
var
   i,l:integer;
begin
     For i:=1 to 3 do
         begin
              For L:=1 to 3 do
                  begin
                       If j=g[i,l]  then
                          begin
                               gotoxy(3,4);
                               writeln('Sujugada ya existe');
                               gotoxy(3,5);
                               writeln('Sujugada nueva jugada es');
                               gotoxy(3,6);
                               clreol;
                               marco1;
                               gotoxy(3,6);
                               readln(J);
                               If j>9 then
                                  begin
                                       gotoxy(3,5);
                                       writeln('Escriba un solo digito');
                                       delay(900);
                                       gotoxy(3,5);
                                       writeln('Sujugada nueva jugada es');
                                       gotoxy(3,6);
                                       clreol;
                                       gotoxy(3,6);
                                       marco1;
                                       readln(J);
                                  end;
                               movida(j);
                          end;
                  end;
         end;
     textcolor(5);
end;
Procedure movidacompu(var j:integer);
var
   i,l:integer;
begin
     For i:=1 to 3 do
         begin
              For L:=1 to 3 do
                  begin
                       If j=g[i,l]  then
                          begin
                               gotoxy(3,4);
                               writeln('Sujugada ya existe');
                               gotoxy(3,5);
                               writeln('Sujugada nueva jugada es');
                               gotoxy(3,6);
                               clreol;
                               marco1;
                               gotoxy(3,6);
                               readln(J);
                               If j>9 then
                                  begin
                                       compu(j);
                                  end;
                               movida(j);
                          end;
                  end;
         end;
     textcolor(5);
end;
procedure comparar(var j,i,l:integer);
begin
     l:=l+1;
     g[i,l]:=j;
     if l=3 then
        begin
             i:=i+1;
             l:=0;
        end;
     g[i,l]:=j;
end;
Procedure limpiar;
var
   i,l:integer;
begin
     For i:=1 to 3 do
         begin
              For L:=1 to 3 do
                  begin
                       g[i,l]:=0;
                  end;
         end;
end;

Procedure llamada(t:integer);
var
   j:integer;
begin
     clrscr;
     gato;
     repeat
           Jugada(j,c);
           if j=55 then
              begin
                   t:=9;
              end;
           movida(j);
           t:=t+1;
           comparar(j,i,l);
           gano(a1,a2,a3,a4,a5,a6,a7,a8,a9,j,t);
           If t=9 then
              begin
                   gotoxy(20,22);
                   textcolor(red);
                   writeln('Nadie GANO el juego');
                   readkey;
              end;
     until (Q=9)or(t>9)OR(T=9);
end;

Procedure comprovando;
begin
     error:=0;
     jugadores;
     If error>0 then
        begin
             repeat
                   jugadores;
             until corre=1;
        end;
     info;
end;
Procedure comprovandocompu;
begin
     error:=0;
     jugadorescompu;
     If error>0 then
        begin
             repeat
                   jugadorescompu;
             until corre=1;
        end;
     info;
end;
Procedure llamadacompu(t:integer);
var
   j:integer;
begin
     limpiar;
     textcolor(1);
     a1:='*';
     a2:='*';
     a3:='*';
     a4:='*';
     a5:='*';
     a6:='*';
     a7:='*';
     a8:='*';
     a9:='*';
     Q:=0;
     t:=0;
     i:=1;
     l:=0;
     c:=0;
     g1:=0;
     h1:=0;
     corre:=0;
     comprovandocompu;
     clrscr;
     gato;
     repeat
           Jugadaconcompu(j,c);
           if j=55 then
              begin
                   t:=9;
              end;
           movidacompu(j);
           t:=t+1;
           comparar(j,i,l);
           gano(a1,a2,a3,a4,a5,a6,a7,a8,a9,j,t);
           If t=9 then
              begin
                   gotoxy(20,22);
                   textcolor(red);
                   writeln('Nadie GANO el juego');
                   readkey;
              end;
     until (Q=9)or(t>9)OR(T=9);

end;

Procedure nuevo;
var
   res:char;
begin
     clrscr;
     marco1;
     textcolor(green);
     gotoxy(25,12);
     writeln('Los mismos jugadores S/N');
     res:=upcase(readkey);
     If res='S'then
        begin
             clrscr;
             limpiar;
             textcolor(1);
             a1:='*';
             a2:='*';
             a3:='*';
             a4:='*';
             a5:='*';
             a6:='*';
             a7:='*';
             a8:='*';
             a9:='*';
             Q:=0;
             t:=0;
             i:=1;
             l:=0;
             c:=0;
             g1:=0;
             h1:=0;
        end
     Else
         begin
              clrscr;
              limpiar;
              textcolor(1);
              a1:='*';
              a2:='*';
              a3:='*';
              a4:='*';
              a5:='*';
              a6:='*';
              a7:='*';
              a8:='*';
              a9:='*';
              Q:=0;
              t:=0;
              i:=1;
              l:=0;
              c:=0;
              g1:=0;
              h1:=0;
              corre:=0;
              nom1:='';
              nom2:='';
              comprovando;
         end;
end;
procedure dosju;
begin
     If co>1 then
              begin
                   nuevo;
              end;
           llamada(t);
           clrscr;
           limpiar;
           t:=0;
           i:=1;
           l:=0;
           c:=0;
           g1:=0;
           h1:=0;
end;

Procedure computadora;
begin
     clrscr;
     marco1;
     gotoxy(30,11);
     textcolor(red);
     writeln('COMO DESEA JUGAR');
     gotoxy(23,13);
     textcolor(14);
     writeln('1.Jugador uno contra jugador dos');
     gotoxy(23,14);
     writeln('2.Jugador uno contra la Computadora');
     gotoxy(24,16);
     textcolor(5);
     writeln('[ ]');
     gotoxy(25,16);
     readln(contra);
     case contra of
          1:begin
                 if xz=1 then
                    begin
                         comprovando;
                         xz:=xz+2;
                    end;
                 dosju;
          end;
          2:begin
                 for wq:=1 to 45 do
                     begin
                          z[wq]:=1;
                     end;
                 llamadacompu(t);
          end;
     end;
     clrscr;
     limpiar;
     textcolor(1);
     a1:='*';
     a2:='*';
     a3:='*';
     a4:='*';
     a5:='*';
     a6:='*';
     a7:='*';
     a8:='*';
     a9:='*';
     Q:=0;
     t:=0;
     i:=1;
     l:=0;
     c:=0;
     g1:=0;
     h1:=0;
     corre:=0;
end;
Procedure seguir;
var
   con:char;
begin
     co:=1;
     xz:=1;
     numeros:=2;
     mar:=4;
     pre:=5;
     ju1:=8;
     ju2:=6;
     repeat
           computadora;
           marco1;
           textcolor(green);
           gotoxy(23,12);
           writeln('Desea continuar jugando S/N ');
           co:=co+1;
           con:=upcase(readkey);
     until con='N';
end;
Procedure portada;
begin
     marco1;
     TEXTCOLOR(10);
     gotoxy(29,13);
     writeln('LA LLEGADA DEL GATO');
     READKEY;
END;
Procedure final;
begin
     clrscr;
     marco1;
     TEXTCOLOR(4);
     gotoxy(37,13);
     writeln('FIN');
     READKEY;
end;
Begin
     clrscr;
     limpiar;
     t:=0;
     i:=1;
     l:=0;
     c:=0;
     g1:=0;
     h1:=0;
     nom1:='';
     nom2:='';
     a1:='*';
     a2:='*';
     a3:='*';
     a4:='*';
     a5:='*';
     a6:='*';
     a7:='*';
     a8:='*';
     a9:='*';
     portada;
     seguir;
     final;
end.
